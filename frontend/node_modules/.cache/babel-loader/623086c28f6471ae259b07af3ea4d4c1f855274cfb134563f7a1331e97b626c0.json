{"ast":null,"code":"import _objectWithoutProperties from\"C:/Users/Ammaarah/EventuallyPerfect/QUANTIX/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties.js\";import _toPropertyKey from\"C:/Users/Ammaarah/EventuallyPerfect/QUANTIX/node_modules/@babel/runtime/helpers/esm/toPropertyKey.js\";import _objectSpread from\"C:/Users/Ammaarah/EventuallyPerfect/QUANTIX/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import{useEffect,useState,useRef}from\"react\";import{supabase}from\"../client\";import{FaArrowLeft,FaCalendarAlt,FaCheck,FaClock,FaFileAlt,FaPlus,FaSearch,FaTimes,FaUpload,FaUsers}from\"react-icons/fa\";import{useNavigate}from\"react-router-dom\";import\"../AddEventForm.css\";import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";export default function AddEventForm(){var _selectedVenueVendor$;const navigate=useNavigate();// Function to handle vendor card click\nconst handleVendorCardClick=vendorId=>{navigate(\"/vendors/\".concat(vendorId,\"/services?readonly=true\"));};const[isSubmitting,setIsSubmitting]=useState(false);const[formData,setFormData]=useState({name:\"\",date:\"\",time:\"\",theme:\"\",venue:\"\",end_time:\"\"});const vendorCategories=[\"Catering\",\"Flowers\",\"Venue\",\"Photography\",\"Music\",\"Decor\"];const[allVendors,setAllVendors]=useState([]);const[filteredVendors,setFilteredVendors]=useState([]);const[selectedVendors,setSelectedVendors]=useState([]);const[vendorRequests,setVendorRequests]=useState({});// Track vendor request statuses\nconst[searchTerm,setSearchTerm]=useState(\"\");const[searchInput,setSearchInput]=useState(\"\");const[selectedCategory,setSelectedCategory]=useState(\"All\");const[isLoading,setIsLoading]=useState(true);const[isSearching,setIsSearching]=useState(false);const[documents,setDocuments]=useState([]);const[usingVenueVendor,setUsingVenueVendor]=useState(false);const[selectedVenueVendor,setSelectedVenueVendor]=useState(null);const[selectedVenueIndex,setSelectedVenueIndex]=useState(0);const[showVenueDropdown,setShowVenueDropdown]=useState(false);const[searchError,setSearchError]=useState(null);const searchTimeoutRef=useRef(null);// New state for pop-up messages\nconst[warningMessage,setWarningMessage]=useState(\"\");const[showWarning,setShowWarning]=useState(false);const[successMessage,setSuccessMessage]=useState(\"\");const[showSuccess,setShowSuccess]=useState(false);const handleChange=e=>{const{name,value}=e.target;// If manually changing the venue field, disable the venue vendor selection\nif(name===\"venue\"&&usingVenueVendor){setUsingVenueVendor(false);setSelectedVenueVendor(null);}setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{[name]:value}));// Add/remove has-value class for floating labels\nif(value){e.target.classList.add(\"has-value\");}else{e.target.classList.remove(\"has-value\");}};const handleFileChange=e=>{const files=Array.from(e.target.files);const allowedFiles=files.filter(file=>{if(file.size>10*1024*1024){// 10MB limit\nsetWarningMessage(\"File is too large: \".concat(file.name,\". Maximum size is 10 MB.\"));setShowWarning(true);return false;}return true;});setDocuments(prev=>[...prev,...allowedFiles]);};const handleRemoveDocument=docToRemove=>{setDocuments(documents.filter(doc=>doc.name!==docToRemove.name));};useEffect(()=>{// Mock vendor data for development\nconst mockVendors=[{vendor_id:1,business_name:\"Elegant Events\",service_type:\"Venue\",contact_number:\"(555) 123-4567\",email:\"info@elegantevents.com\",address:\"123 Event St, New York, NY\",description:\"A beautiful venue for all types of events with modern amenities and professional staff.\"},{vendor_id:2,business_name:\"Perfect Clicks Photography\",service_type:\"Photography\",contact_number:\"(555) 234-5678\",email:\"hello@perfectclicks.com\",address:\"456 Photo Ave, New York, NY\",description:\"Professional photography services capturing your special moments with creativity and style.\"},{vendor_id:3,business_name:\"Melody Makers\",service_type:\"Music\",contact_number:\"(555) 345-6789\",email:\"bookings@melodymakers.com\",address:\"789 Music Ln, New York, NY\",description:\"Live music band providing entertainment for all types of events and celebrations.\"},{vendor_id:4,business_name:\"Blooms & Petals\",service_type:\"Florist\",contact_number:\"(555) 456-7890\",email:\"info@bloomsandpetals.com\",address:\"321 Flower Rd, New York, NY\",description:\"Floral arrangements and decorations to make your event beautiful and memorable.\"},{vendor_id:5,business_name:\"Gourmet Delights\",service_type:\"Catering\",contact_number:\"(555) 567-8901\",email:\"catering@gourmetdelights.com\",address:\"654 Food Blvd, New York, NY\",description:\"Delicious catering services with a variety of menu options for any occasion.\"}];const fetchVendors=async()=>{setIsLoading(true);setSearchError(null);try{// Get the user session\nconst{data:{session}}=await supabase.auth.getSession();if(!session){throw new Error(\"No active session. Please log in.\");}// Use the same API URL as PlannerDashboard\nconst API_URL=process.env.NODE_ENV===\"production\"?\"https://quantix-production.up.railway.app\":\"http://localhost:5000\";const response=await fetch(\"\".concat(API_URL,\"/api/vendors\"),{headers:{\"Content-Type\":\"application/json\",Accept:\"application/json\",Authorization:\"Bearer \".concat(session.access_token)}});if(!response.ok){throw new Error(\"Failed to fetch vendors: \".concat(response.status,\" \").concat(response.statusText));}const data=await response.json();if(!Array.isArray(data)){throw new Error(\"Invalid vendor data format received\");}console.log(\"Fetched vendors:\",data);setAllVendors(data);setFilteredVendors(data);}catch(error){console.error(\"Error fetching vendors:\",error);// Fallback to mock data in development\nif(process.env.NODE_ENV===\"development\"){console.warn(\"Using mock vendor data due to API error\");setAllVendors(mockVendors);setFilteredVendors(mockVendors);setSearchError(\"Using sample vendor data. Some features may be limited.\");}else{setSearchError(\"Failed to load vendors. Please try again later.\");}}finally{setIsLoading(false);}};fetchVendors();},[]);// Empty dependency array since we don't have any external dependencies\n// Debounced search effect\nuseEffect(()=>{if(searchTimeoutRef.current){clearTimeout(searchTimeoutRef.current);}if(searchInput.trim()===searchTerm){return;}setIsSearching(true);searchTimeoutRef.current=setTimeout(()=>{setSearchTerm(searchInput.trim().toLowerCase());setIsSearching(false);},300);return()=>{if(searchTimeoutRef.current){clearTimeout(searchTimeoutRef.current);}};},[searchInput,searchTerm]);// Filter vendors based on search term and category\nuseEffect(()=>{const filterVendors=()=>{try{let result=[...allVendors];// Filter by category\nif(selectedCategory!==\"All\"){result=result.filter(v=>v.service_type&&v.service_type.toLowerCase()===selectedCategory.toLowerCase());}// Filter by search term\nif(searchTerm){result=result.filter(v=>{const searchFields=[v.business_name,v.service_type,v.contact_person,v.email,v.contact_number,v.address,v.description].filter(Boolean).map(field=>field.toLowerCase());return searchFields.some(field=>field.includes(searchTerm));});}setFilteredVendors(result);setSearchError(null);}catch(error){console.error(\"Error filtering vendors:\",error);setSearchError(\"An error occurred while searching. Please try again.\");}};filterVendors();},[searchTerm,selectedCategory,allVendors]);const handleAddVendor=async vendor=>{// Don’t add if already selected or request already sent\nif(selectedVendors.some(v=>v.vendor_id===vendor.vendor_id)||vendorRequests[vendor.vendor_id]){return;}try{var _session$access_token;// Set request as pending in local state\nsetVendorRequests(prev=>_objectSpread(_objectSpread({},prev),{},{[vendor.vendor_id]:{status:\"pending\"}}));// Get current user session\nconst{data:{session}}=await supabase.auth.getSession();if(!session){throw new Error(\"No active session. Please log in.\");}// Get the current event ID (or temporary one if not saved yet)\nconst eventId=formData.event_id||\"temp-\".concat(Date.now());// API base URL\nconst API_URL=process.env.REACT_APP_BASE_URL||(process.env.NODE_ENV===\"production\"?\"https://quantix-production.up.railway.app\":\"http://localhost:5000\");const isDevelopment=process.env.NODE_ENV===\"development\";// Request body – only fields that exist in vendor_requests\nconst requestBody={event_id:eventId,vendor_id:vendor.vendor_id,requester_id:session.user.id,status:\"pending\"};console.log(\"Sending vendor request:\",{url:\"\".concat(API_URL,\"/api/vendor-requests\"),method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat((_session$access_token=session.access_token)===null||_session$access_token===void 0?void 0:_session$access_token.substring(0,10),\"...\")},body:requestBody});let responseData;if(isDevelopment){console.log(\"Development mode: Using mock vendor request response\");await new Promise(resolve=>setTimeout(resolve,500));responseData={success:true,request:{id:\"mock-\".concat(Date.now()),event_id:requestBody.event_id,vendor_id:requestBody.vendor_id,requester_id:requestBody.requester_id,status:\"pending\",created_at:new Date().toISOString()}};}else{const response=await fetch(\"\".concat(API_URL,\"/api/vendor-requests\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(session.access_token)},body:JSON.stringify(requestBody)});try{responseData=await response.json();}catch(err){const errorText=await response.text();throw new Error(\"Invalid JSON response: \".concat(errorText));}if(!response.ok){var _responseData;const errorMessage=((_responseData=responseData)===null||_responseData===void 0?void 0:_responseData.error)||\"Failed to send vendor request: \".concat(response.status,\" \").concat(response.statusText);throw new Error(errorMessage);}}// Update local state with actual request data\nsetVendorRequests(prev=>_objectSpread(_objectSpread({},prev),{},{[vendor.vendor_id]:{status:responseData.request.status,request_id:responseData.request.request_id}}));setSelectedVendors(prev=>[...prev,_objectSpread(_objectSpread({},vendor),{},{request_status:responseData.request.status,request_id:responseData.request.request_id})]);setSuccessMessage(\"Request sent to \".concat(vendor.business_name));setShowSuccess(true);}catch(error){console.error(\"Error sending vendor request:\",error);// Remove pending status on error\nconst _vendor$vendor_id=vendor.vendor_id,{[_vendor$vendor_id]:_}=vendorRequests,remainingRequests=_objectWithoutProperties(vendorRequests,[_vendor$vendor_id].map(_toPropertyKey));setVendorRequests(remainingRequests);setShowWarning(true);setWarningMessage(\"Failed to send request to \".concat(vendor.business_name,\". \").concat(error.message||\"Unknown error occurred\",\". Please try again or contact support if the problem persists.\"));if(error.message.includes(\"401\")){setWarningMessage(prev=>prev+\" You may need to log in again.\");}}};const handleRemoveVendor=async vendorToRemove=>{const vendorName=vendorToRemove.business_name||\"Vendor\";try{// If there's a pending/accepted request, we should cancel it\nif(vendorToRemove.request_id){const{data:{session}}=await supabase.auth.getSession();if(!session){throw new Error(\"No active session\");}const API_URL=process.env.REACT_APP_BASE_URL||(process.env.NODE_ENV===\"production\"?\"https://quantix-production.up.railway.app\":\"http://localhost:5000\");// In development, just simulate the deletion\nif(process.env.NODE_ENV===\"development\"){console.log(\"Development mode: Simulating request cancellation for\",vendorToRemove.request_id);await new Promise(resolve=>setTimeout(resolve,500));}else{// Make the actual API call in production\nconst response=await fetch(\"\".concat(API_URL,\"/api/vendor-requests/\").concat(vendorToRemove.request_id),{method:\"DELETE\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(session.access_token)}});if(!response.ok){const errorData=await response.json().catch(()=>({}));throw new Error(errorData.message||\"Failed to cancel request: \".concat(response.status,\" \").concat(response.statusText));}}}// Remove from selected vendors\nsetSelectedVendors(prev=>prev.filter(vendor=>vendor.vendor_id!==vendorToRemove.vendor_id));// Remove from requests tracking\nsetVendorRequests(prev=>{const _vendorToRemove$vendo=vendorToRemove.vendor_id,{[_vendorToRemove$vendo]:_}=prev,remaining=_objectWithoutProperties(prev,[_vendorToRemove$vendo].map(_toPropertyKey));return remaining;});// Show success message\nsetSuccessMessage(\"Request to \".concat(vendorName,\" has been cancelled.\"));setShowSuccess(true);}catch(error){console.error(\"Error cancelling vendor request:\",error);setWarningMessage(\"Failed to cancel request to \".concat(vendorName,\". \")+\"\".concat(error.message||\"Please try again.\"));setShowWarning(true);}};const getVendorStatus=vendor=>{if(vendor.request_id){return vendor.request_status;}else if(vendorRequests[vendor.vendor_id]){return vendorRequests[vendor.vendor_id].status;}else{return null;}};const handleSubmit=async e=>{e.preventDefault();setIsSubmitting(true);setShowWarning(false);setShowSuccess(false);// Basic validation\nif(!formData.name||!formData.date){setWarningMessage(\"Please fill in at least the event name and date.\");setShowWarning(true);setIsSubmitting(false);return;}const{data:{user}}=await supabase.auth.getUser();if(!user){setWarningMessage(\"You must be logged in to create an event.\");setShowWarning(true);setIsSubmitting(false);return;}const selectedDate=new Date(formData.date);const today=new Date();today.setHours(0,0,0,0);if(selectedDate<today){setWarningMessage(\"Please select a future date.\");setShowWarning(true);setIsSubmitting(false);return;}try{// 1️⃣ Create event in Supabase\nconst{data:eventData,error:eventError}=await supabase.from(\"events\").insert({name:formData.name,theme:formData.theme||null,start_time:formData.time?\"\".concat(formData.date,\"T\").concat(formData.time):\"\".concat(formData.date,\"T00:00:00\"),end_time:formData.end_time||null,venue:formData.venue||null,planner_id:user.id}).select().single();if(eventError)throw eventError;setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{event_id:eventData.event_id}));// 2️⃣ Send vendor requests via backend API\nconst API_URL=process.env.REACT_APP_BASE_URL||(process.env.NODE_ENV===\"production\"?\"https://quantix-production.up.railway.app\":\"http://localhost:5000\");for(const vendor of selectedVendors){const response=await fetch(\"\".concat(API_URL,\"/api/vendor-requests\"),{method:\"POST\",headers:{\"Content-Type\":\"application/json\",Authorization:\"Bearer \".concat(user.id)},body:JSON.stringify({event_id:eventData.event_id,vendor_id:vendor.vendor_id,requester_id:user.id})});const data=await response.json();if(!response.ok){console.error(\"Failed to send vendor request:\",data.error);throw new Error(data.error||\"Failed to send request for vendor \".concat(vendor.vendor_id));}}// 3️⃣ Upload documents to Supabase Storage\nif(documents.length>0){const uploadedDocuments=await Promise.all(documents.map(async docFile=>{const safeEventName=formData.name.replace(/\\s+/g,\"_\").replace(/[^\\w-]/g,\"\");const filePath=\"planners/\".concat(user.id,\"/\").concat(safeEventName,\"/\").concat(docFile.name);const{error:uploadError}=await supabase.storage.from(\"event-documents\").upload(filePath,docFile);if(uploadError)throw uploadError;const{data:{publicUrl}}=supabase.storage.from(\"event-documents\").getPublicUrl(filePath);return{name:docFile.name,url:publicUrl,file_type:docFile.type||\"application/octet-stream\"};}));// Insert file records into files table\nconst fileRecords=uploadedDocuments.map(doc=>({event_id:eventData.event_id,uploaded_by:user.id,file_name:doc.name,file_type:doc.file_type,file_url:doc.url}));const{error:fileError}=await supabase.from(\"files\").insert(fileRecords);if(fileError)throw fileError;}setSuccessMessage(\"Event created successfully!\");setShowSuccess(true);}catch(error){console.error(\"Error creating event:\",error);setWarningMessage(error.message||\"Failed to create event. Please try again.\");setShowWarning(true);}finally{setIsSubmitting(false);}};useEffect(()=>{const handleClickOutside=event=>{if(showVenueDropdown&&!event.target.closest(\".form-group\")){setShowVenueDropdown(false);}};document.addEventListener(\"mousedown\",handleClickOutside);return()=>{document.removeEventListener(\"mousedown\",handleClickOutside);};},[showVenueDropdown]);return/*#__PURE__*/_jsxs(_Fragment,{children:[showSuccess&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,right:0,bottom:0,backgroundColor:\"rgba(0, 0, 0, 0.8)\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",zIndex:10000,animation:\"fadeIn 0.3s ease-out\",pointerEvents:\"auto\",backdropFilter:\"blur(2px)\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"white\",borderRadius:\"16px\",boxShadow:\"0 8px 32px rgba(0, 0, 0, 0.3)\",padding:\"2.5rem 3rem\",position:\"relative\",minWidth:\"350px\",maxWidth:\"90%\",textAlign:\"center\",border:\"2px solid #E5ACBF\",zIndex:10001},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>{setShowSuccess(false);// ===== FIX #2: Only navigate if it's the event creation message =====\nif(successMessage===\"Event created successfully!\"){navigate(\"/dashboard\");}},style:{position:\"absolute\",top:\"0.75rem\",right:\"1rem\",background:\"none\",border:\"none\",fontSize:\"1.5rem\",cursor:\"pointer\",color:\"#666\",padding:\"0.25rem 0.5rem\",lineHeight:1,fontWeight:\"bold\",transition:\"color 0.2s\"},onMouseOver:e=>e.target.style.color=\"#E5ACBF\",onMouseOut:e=>e.target.style.color=\"#666\",children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:\"1rem 0 0\",color:\"#333\",fontWeight:500,fontSize:\"1.1rem\",padding:\"0 1rem\"},children:successMessage})]})}),showWarning&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"fixed\",top:0,left:0,right:0,bottom:0,backgroundColor:\"rgba(0, 0, 0, 0.8)\",display:\"flex\",justifyContent:\"center\",alignItems:\"center\",zIndex:10000,animation:\"fadeIn 0.3s ease-out\",pointerEvents:\"auto\",backdropFilter:\"blur(2px)\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{background:\"white\",borderRadius:\"16px\",boxShadow:\"0 8px 32px rgba(0, 0, 0, 0.3)\",padding:\"2.5rem 3rem\",position:\"relative\",minWidth:\"350px\",maxWidth:\"90%\",textAlign:\"center\",border:\"2px solid #E5ACBF\",zIndex:10001},children:[/*#__PURE__*/_jsx(\"button\",{onClick:()=>setShowWarning(false),style:{position:\"absolute\",top:\"0.75rem\",right:\"1rem\",background:\"none\",border:\"none\",fontSize:\"1.5rem\",cursor:\"pointer\",color:\"#666\",padding:\"0.25rem 0.5rem\",lineHeight:1,fontWeight:\"bold\",transition:\"color 0.2s\"},onMouseOver:e=>e.target.style.color=\"#E5ACBF\",onMouseOut:e=>e.target.style.color=\"#666\",children:\"\\xD7\"}),/*#__PURE__*/_jsx(\"p\",{style:{margin:\"1rem 0 0\",color:\"#333\",fontWeight:500,fontSize:\"1.1rem\",padding:\"0 1rem\"},children:warningMessage})]})}),/*#__PURE__*/_jsxs(\"div\",{className:\"profile-container\",children:[/*#__PURE__*/_jsxs(\"button\",{className:\"back-button\",onClick:()=>navigate(\"/dashboard\"),children:[/*#__PURE__*/_jsx(FaArrowLeft,{}),\" Back to Dashboard\"]}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Create a New \",/*#__PURE__*/_jsx(\"span\",{className:\"accent-text\",children:\"Event\"})]}),/*#__PURE__*/_jsx(\"p\",{children:\"Plan your perfect event by adding details, vendors, and documents\"}),/*#__PURE__*/_jsx(\"div\",{className:\"form-sections\",children:/*#__PURE__*/_jsxs(\"form\",{className:\"profile-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"name\",value:formData.name,onChange:handleChange,className:\"form-input\",required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Event Name\"})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"1rem\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{flex:1},children:[/*#__PURE__*/_jsx(FaCalendarAlt,{className:\"form-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"date\",name:\"date\",value:formData.date,min:new Date().toISOString().split(\"T\")[0],onChange:handleChange,className:\"form-input\",required:true}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Date\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{flex:1},children:[/*#__PURE__*/_jsx(FaClock,{className:\"form-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",name:\"time\",value:formData.time,onChange:handleChange,className:\"form-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Time (Optional)\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{style:{display:\"flex\",gap:\"1rem\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",style:{flex:1},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"theme\",value:formData.theme,onChange:handleChange,className:\"form-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"Theme (Optional)\"})]}),/*#__PURE__*/_jsx(\"div\",{className:\"form-group\",style:{flex:1,position:\"relative\"},children:/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",name:\"venue\",value:formData.venue,onChange:handleChange,className:\"form-input\",disabled:usingVenueVendor,onFocus:()=>usingVenueVendor&&setShowVenueDropdown(true),style:usingVenueVendor?{backgroundColor:\"#f5f5f5\",cursor:\"pointer\",paddingRight:\"35px\"}:{}}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:usingVenueVendor?\"Venue (Selected from Vendor)\":\"Venue (Optional)\"}),usingVenueVendor&&(selectedVenueVendor===null||selectedVenueVendor===void 0?void 0:(_selectedVenueVendor$=selectedVenueVendor.venue_names)===null||_selectedVenueVendor$===void 0?void 0:_selectedVenueVendor$.length)>1&&/*#__PURE__*/_jsxs(\"div\",{style:{position:\"relative\"},children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>setShowVenueDropdown(!showVenueDropdown),style:{position:\"absolute\",right:\"30px\",top:\"50%\",transform:\"translateY(-50%)\",background:\"none\",border:\"none\",color:\"#666\",cursor:\"pointer\",fontSize:\"0.8rem\",padding:\"2px 5px\",borderRadius:\"4px\",transition:\"all 0.2s\"},onMouseOver:e=>e.target.style.background=\"rgba(0,0,0,0.05)\",onMouseOut:e=>e.target.style.background=\"transparent\",title:\"Select a different venue\",children:\"\\u25BC\"}),showVenueDropdown&&/*#__PURE__*/_jsx(\"div\",{style:{position:\"absolute\",top:\"100%\",left:0,right:0,backgroundColor:\"white\",border:\"1px solid #ddd\",borderRadius:\"4px\",boxShadow:\"0 4px 8px rgba(0,0,0,0.1)\",zIndex:1000,maxHeight:\"200px\",overflowY:\"auto\",marginTop:\"4px\"},children:selectedVenueVendor.venue_names.map((venue,idx)=>/*#__PURE__*/_jsx(\"div\",{onClick:()=>{setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{venue}));setSelectedVenueIndex(idx);setShowVenueDropdown(false);},style:{padding:\"8px 12px\",cursor:\"pointer\",backgroundColor:idx===selectedVenueIndex?\"#f0f0f0\":\"transparent\",\":hover\":{backgroundColor:\"#f5f5f5\"}},children:venue},idx))})]}),usingVenueVendor&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setUsingVenueVendor(false);setFormData(prev=>_objectSpread(_objectSpread({},prev),{},{venue:\"\"}));setShowVenueDropdown(false);},style:{position:\"absolute\",right:\"10px\",top:\"50%\",transform:\"translateY(-50%)\",background:\"none\",border:\"none\",color:\"#666\",cursor:\"pointer\",fontSize:\"1rem\",padding:\"5px\",borderRadius:\"50%\",display:\"flex\",alignItems:\"center\",justifyContent:\"center\",transition:\"all 0.2s\"},onMouseOver:e=>e.target.style.background=\"rgba(0,0,0,0.05)\",onMouseOut:e=>e.target.style.background=\"transparent\",title:\"Use custom venue name instead\",children:/*#__PURE__*/_jsx(FaTimes,{})})]})})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-group\",children:[/*#__PURE__*/_jsx(FaClock,{className:\"form-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"time\",name:\"end_time\",value:formData.end_time,onChange:handleChange,className:\"form-input\"}),/*#__PURE__*/_jsx(\"label\",{className:\"form-label\",children:\"End Time (Optional)\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"optional-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(FaUsers,{}),\" Vendors\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"optional-tag\",children:\"Optional\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Add vendors to your event to keep everything organized in one place\"}),/*#__PURE__*/_jsxs(\"div\",{className:\"vendor-search-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"search-box\",children:[/*#__PURE__*/_jsx(FaSearch,{className:\"search-icon\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",placeholder:\"Search for vendors by name or category\",value:searchInput,onChange:e=>setSearchInput(e.target.value),className:\"search-input\",disabled:isLoading}),(isSearching||isLoading)&&/*#__PURE__*/_jsx(\"div\",{className:\"search-loading\",children:/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"})}),!isSearching&&searchInput&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>{setSearchInput(\"\");setSearchTerm(\"\");},className:\"clear-search\",\"aria-label\":\"Clear search\",children:/*#__PURE__*/_jsx(FaTimes,{})})]}),/*#__PURE__*/_jsxs(\"select\",{value:selectedCategory,onChange:e=>setSelectedCategory(e.target.value),className:\"category-filter\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"All\",children:\"All Categories\"}),vendorCategories.map((cat,idx)=>/*#__PURE__*/_jsx(\"option\",{value:cat,children:cat},idx))]})]}),searchError&&/*#__PURE__*/_jsxs(\"div\",{className:\"search-error\",children:[/*#__PURE__*/_jsx(FaTimes,{className:\"error-icon\"}),\" \",searchError]}),isLoading?/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Loading vendors...\"})]}):isSearching?/*#__PURE__*/_jsxs(\"div\",{className:\"loading\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"spinner\"}),/*#__PURE__*/_jsx(\"p\",{children:\"Searching vendors...\"})]}):filteredVendors.length===0?/*#__PURE__*/_jsxs(\"div\",{className:\"no-results\",children:[/*#__PURE__*/_jsx(\"p\",{children:\"No vendors found matching your search.\"}),searchTerm&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"clear-filters\",onClick:()=>{setSearchInput(\"\");setSearchTerm(\"\");setSelectedCategory(\"All\");},children:\"Clear all filters\"})]}):/*#__PURE__*/_jsx(\"div\",{className:\"vendor-grid\",children:filteredVendors.map(vendor=>/*#__PURE__*/_jsxs(\"div\",{className:\"vendor-card\",onClick:e=>{// Only navigate if the click is not on the request button or its children\nif(!e.target.closest('.add-vendor-btn, .undo-request-btn')){handleVendorCardClick(vendor.vendor_id);}},style:{cursor:'pointer'},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"vendor-info\",children:[/*#__PURE__*/_jsx(\"h4\",{children:vendor.business_name}),/*#__PURE__*/_jsx(\"div\",{className:\"vendor-category\",children:vendor.service_type}),/*#__PURE__*/_jsx(\"div\",{className:\"vendor-description\",children:vendor.description||\"No description available.\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"vendor-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"add-vendor-btn \".concat(getVendorStatus(vendor)?\"added\":\"\",\" \").concat(getVendorStatus(vendor)===\"pending\"?\"pending\":\"\"),onClick:()=>handleAddVendor(vendor),disabled:!!getVendorStatus(vendor),title:getVendorStatus(vendor)===\"pending\"?\"Request pending\":\"\",children:getVendorStatus(vendor)===\"pending\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FaClock,{}),\" Requested\"]}):getVendorStatus(vendor)===\"accepted\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FaCheck,{}),\" Confirmed\"]}):getVendorStatus(vendor)===\"rejected\"?/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FaTimes,{}),\" Declined\"]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(FaPlus,{}),\" Request Vendor\"]})}),getVendorStatus(vendor)===\"pending\"&&/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"undo-request-btn\",onClick:e=>{e.stopPropagation();e.preventDefault();handleRemoveVendor(vendor);},onKeyDown:e=>{if(e.key===\"Enter\"||e.key===\" \"){e.stopPropagation();e.preventDefault();handleRemoveVendor(vendor);}},title:\"Cancel request\",children:\"Undo\"})]})]},vendor.vendor_id))}),selectedVendors.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"selected-vendors\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"selected-title\",children:\"Selected Vendors\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"selected-vendors-list\",children:selectedVendors.map(v=>/*#__PURE__*/_jsxs(\"li\",{className:\"selected-vendor-item\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"span\",{className:\"vendor-name\",children:v.business_name}),/*#__PURE__*/_jsx(\"span\",{className:\"vendor-type\",children:v.service_type})]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleRemoveVendor(v),className:\"remove-vendor-btn\",title:\"Remove vendor\",children:/*#__PURE__*/_jsx(FaTimes,{})})]},v.vendor_id))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"optional-section\",children:[/*#__PURE__*/_jsxs(\"h3\",{children:[/*#__PURE__*/_jsx(FaFileAlt,{}),\" Documents\",\" \",/*#__PURE__*/_jsx(\"span\",{className:\"optional-tag\",children:\"Optional\"})]}),/*#__PURE__*/_jsx(\"p\",{className:\"section-description\",children:\"Upload contracts, invoices, or other important files related to your event\"}),/*#__PURE__*/_jsx(\"div\",{className:\"file-upload-area\",children:/*#__PURE__*/_jsxs(\"label\",{className:\"file-upload-label\",children:[/*#__PURE__*/_jsx(\"input\",{type:\"file\",multiple:true,onChange:handleFileChange,className:\"file-input\"}),/*#__PURE__*/_jsx(FaUpload,{className:\"upload-icon\"}),/*#__PURE__*/_jsx(\"h3\",{className:\"upload-title\",children:\"Upload Files\"}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-subtitle\",children:\"Drag & drop files here or click to browse\"}),/*#__PURE__*/_jsx(\"p\",{className:\"upload-hint\",children:\"Maximum file size: 10MB per file\"})]})}),documents.length>0&&/*#__PURE__*/_jsxs(\"div\",{className:\"documents-list\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"documents-title\",children:\"Uploaded Files\"}),/*#__PURE__*/_jsx(\"ul\",{className:\"documents-container\",children:documents.map((doc,idx)=>/*#__PURE__*/_jsxs(\"li\",{className:\"document-item\",children:[/*#__PURE__*/_jsx(FaFileAlt,{className:\"file-icon\"}),/*#__PURE__*/_jsx(\"span\",{className:\"file-name\",children:doc.name}),/*#__PURE__*/_jsxs(\"span\",{className:\"file-size\",children:[\"(\",(doc.size/1024).toFixed(1),\" KB)\"]}),/*#__PURE__*/_jsx(\"button\",{type:\"button\",onClick:()=>handleRemoveDocument(doc),className:\"remove-document-btn\",title:\"Remove file\",children:/*#__PURE__*/_jsx(FaTimes,{})})]},idx))})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"form-actions\",children:[/*#__PURE__*/_jsx(\"button\",{type:\"button\",className:\"cancel-btn\",onClick:()=>{setShowWarning(false);navigate(\"/dashboard\");},children:\"Cancel\"}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-btn\",disabled:isSubmitting,children:isSubmitting?\"Creating Event...\":\"Create Event\"})]})]})})]})]});}","map":{"version":3,"names":["useEffect","useState","useRef","supabase","FaArrowLeft","FaCalendarAlt","FaCheck","FaClock","FaFileAlt","FaPlus","FaSearch","FaTimes","FaUpload","FaUsers","useNavigate","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","AddEventForm","_selectedVenueVendor$","navigate","handleVendorCardClick","vendorId","concat","isSubmitting","setIsSubmitting","formData","setFormData","name","date","time","theme","venue","end_time","vendorCategories","allVendors","setAllVendors","filteredVendors","setFilteredVendors","selectedVendors","setSelectedVendors","vendorRequests","setVendorRequests","searchTerm","setSearchTerm","searchInput","setSearchInput","selectedCategory","setSelectedCategory","isLoading","setIsLoading","isSearching","setIsSearching","documents","setDocuments","usingVenueVendor","setUsingVenueVendor","selectedVenueVendor","setSelectedVenueVendor","selectedVenueIndex","setSelectedVenueIndex","showVenueDropdown","setShowVenueDropdown","searchError","setSearchError","searchTimeoutRef","warningMessage","setWarningMessage","showWarning","setShowWarning","successMessage","setSuccessMessage","showSuccess","setShowSuccess","handleChange","e","value","target","prev","_objectSpread","classList","add","remove","handleFileChange","files","Array","from","allowedFiles","filter","file","size","handleRemoveDocument","docToRemove","doc","mockVendors","vendor_id","business_name","service_type","contact_number","email","address","description","fetchVendors","data","session","auth","getSession","Error","API_URL","process","env","NODE_ENV","response","fetch","headers","Accept","Authorization","access_token","ok","status","statusText","json","isArray","console","log","error","warn","current","clearTimeout","trim","setTimeout","toLowerCase","filterVendors","result","v","searchFields","contact_person","Boolean","map","field","some","includes","handleAddVendor","vendor","_session$access_token","eventId","event_id","Date","now","REACT_APP_BASE_URL","isDevelopment","requestBody","requester_id","user","id","url","method","substring","body","responseData","Promise","resolve","success","request","created_at","toISOString","JSON","stringify","err","errorText","text","_responseData","errorMessage","request_id","request_status","_vendor$vendor_id","_","remainingRequests","_objectWithoutProperties","_toPropertyKey","message","handleRemoveVendor","vendorToRemove","vendorName","errorData","catch","_vendorToRemove$vendo","remaining","getVendorStatus","handleSubmit","preventDefault","getUser","selectedDate","today","setHours","eventData","eventError","insert","start_time","planner_id","select","single","length","uploadedDocuments","all","docFile","safeEventName","replace","filePath","uploadError","storage","upload","publicUrl","getPublicUrl","file_type","type","fileRecords","uploaded_by","file_name","file_url","fileError","handleClickOutside","event","closest","document","addEventListener","removeEventListener","children","style","position","top","left","right","bottom","backgroundColor","display","justifyContent","alignItems","zIndex","animation","pointerEvents","backdropFilter","background","borderRadius","boxShadow","padding","minWidth","maxWidth","textAlign","border","onClick","fontSize","cursor","color","lineHeight","fontWeight","transition","onMouseOver","onMouseOut","margin","className","onSubmit","onChange","required","gap","flex","min","split","disabled","onFocus","paddingRight","venue_names","transform","title","maxHeight","overflowY","marginTop","idx","placeholder","cat","stopPropagation","onKeyDown","key","multiple","toFixed"],"sources":["C:/Users/Ammaarah/EventuallyPerfect/QUANTIX/frontend/src/pages/AddEventForm.jsx"],"sourcesContent":["import { useEffect, useState, useRef } from \"react\";\r\nimport { supabase } from \"../client\";\r\nimport {\r\n  FaArrowLeft,\r\n  FaCalendarAlt,\r\n  FaCheck,\r\n  FaClock,\r\n  FaFileAlt,\r\n  FaPlus,\r\n  FaSearch,\r\n  FaTimes,\r\n  FaUpload,\r\n  FaUsers,\r\n} from \"react-icons/fa\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport \"../AddEventForm.css\";\r\n\r\nexport default function AddEventForm() {\r\n  const navigate = useNavigate();\r\n\r\n  // Function to handle vendor card click\r\n  const handleVendorCardClick = (vendorId) => {\r\n    navigate(`/vendors/${vendorId}/services?readonly=true`);\r\n  };\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n  const [formData, setFormData] = useState({\r\n    name: \"\",\r\n    date: \"\",\r\n    time: \"\",\r\n    theme: \"\",\r\n    venue: \"\",\r\n    end_time: \"\",\r\n  });\r\n  const vendorCategories = [\r\n    \"Catering\",\r\n    \"Flowers\",\r\n    \"Venue\",\r\n    \"Photography\",\r\n    \"Music\",\r\n    \"Decor\",\r\n  ];\r\n\r\n  const [allVendors, setAllVendors] = useState([]);\r\n  const [filteredVendors, setFilteredVendors] = useState([]);\r\n  const [selectedVendors, setSelectedVendors] = useState([]);\r\n  const [vendorRequests, setVendorRequests] = useState({}); // Track vendor request statuses\r\n  const [searchTerm, setSearchTerm] = useState(\"\");\r\n  const [searchInput, setSearchInput] = useState(\"\");\r\n  const [selectedCategory, setSelectedCategory] = useState(\"All\");\r\n  const [isLoading, setIsLoading] = useState(true);\r\n  const [isSearching, setIsSearching] = useState(false);\r\n  const [documents, setDocuments] = useState([]);\r\n  const [usingVenueVendor, setUsingVenueVendor] = useState(false);\r\n  const [selectedVenueVendor, setSelectedVenueVendor] = useState(null);\r\n  const [selectedVenueIndex, setSelectedVenueIndex] = useState(0);\r\n  const [showVenueDropdown, setShowVenueDropdown] = useState(false);\r\n  const [searchError, setSearchError] = useState(null);\r\n  const searchTimeoutRef = useRef(null);\r\n\r\n  // New state for pop-up messages\r\n  const [warningMessage, setWarningMessage] = useState(\"\");\r\n  const [showWarning, setShowWarning] = useState(false);\r\n  const [successMessage, setSuccessMessage] = useState(\"\");\r\n  const [showSuccess, setShowSuccess] = useState(false);\r\n\r\n  const handleChange = (e) => {\r\n    const { name, value } = e.target;\r\n\r\n    // If manually changing the venue field, disable the venue vendor selection\r\n    if (name === \"venue\" && usingVenueVendor) {\r\n      setUsingVenueVendor(false);\r\n      setSelectedVenueVendor(null);\r\n    }\r\n\r\n    setFormData((prev) => ({\r\n      ...prev,\r\n      [name]: value,\r\n    }));\r\n\r\n    // Add/remove has-value class for floating labels\r\n    if (value) {\r\n      e.target.classList.add(\"has-value\");\r\n    } else {\r\n      e.target.classList.remove(\"has-value\");\r\n    }\r\n  };\r\n\r\n  const handleFileChange = (e) => {\r\n    const files = Array.from(e.target.files);\r\n    const allowedFiles = files.filter((file) => {\r\n      if (file.size > 10 * 1024 * 1024) {\r\n        // 10MB limit\r\n        setWarningMessage(\r\n          `File is too large: ${file.name}. Maximum size is 10 MB.`\r\n        );\r\n        setShowWarning(true);\r\n        return false;\r\n      }\r\n      return true;\r\n    });\r\n    setDocuments((prev) => [...prev, ...allowedFiles]);\r\n  };\r\n\r\n  const handleRemoveDocument = (docToRemove) => {\r\n    setDocuments(documents.filter((doc) => doc.name !== docToRemove.name));\r\n  };\r\n\r\n  useEffect(() => {\r\n    // Mock vendor data for development\r\n    const mockVendors = [\r\n      {\r\n        vendor_id: 1,\r\n        business_name: \"Elegant Events\",\r\n        service_type: \"Venue\",\r\n        contact_number: \"(555) 123-4567\",\r\n        email: \"info@elegantevents.com\",\r\n        address: \"123 Event St, New York, NY\",\r\n        description:\r\n          \"A beautiful venue for all types of events with modern amenities and professional staff.\",\r\n      },\r\n      {\r\n        vendor_id: 2,\r\n        business_name: \"Perfect Clicks Photography\",\r\n        service_type: \"Photography\",\r\n        contact_number: \"(555) 234-5678\",\r\n        email: \"hello@perfectclicks.com\",\r\n        address: \"456 Photo Ave, New York, NY\",\r\n        description:\r\n          \"Professional photography services capturing your special moments with creativity and style.\",\r\n      },\r\n      {\r\n        vendor_id: 3,\r\n        business_name: \"Melody Makers\",\r\n        service_type: \"Music\",\r\n        contact_number: \"(555) 345-6789\",\r\n        email: \"bookings@melodymakers.com\",\r\n        address: \"789 Music Ln, New York, NY\",\r\n        description:\r\n          \"Live music band providing entertainment for all types of events and celebrations.\",\r\n      },\r\n      {\r\n        vendor_id: 4,\r\n        business_name: \"Blooms & Petals\",\r\n        service_type: \"Florist\",\r\n        contact_number: \"(555) 456-7890\",\r\n        email: \"info@bloomsandpetals.com\",\r\n        address: \"321 Flower Rd, New York, NY\",\r\n        description:\r\n          \"Floral arrangements and decorations to make your event beautiful and memorable.\",\r\n      },\r\n      {\r\n        vendor_id: 5,\r\n        business_name: \"Gourmet Delights\",\r\n        service_type: \"Catering\",\r\n        contact_number: \"(555) 567-8901\",\r\n        email: \"catering@gourmetdelights.com\",\r\n        address: \"654 Food Blvd, New York, NY\",\r\n        description:\r\n          \"Delicious catering services with a variety of menu options for any occasion.\",\r\n      },\r\n    ];\r\n\r\n    const fetchVendors = async () => {\r\n      setIsLoading(true);\r\n      setSearchError(null);\r\n\r\n      try {\r\n        // Get the user session\r\n        const {\r\n          data: { session },\r\n        } = await supabase.auth.getSession();\r\n        if (!session) {\r\n          throw new Error(\"No active session. Please log in.\");\r\n        }\r\n\r\n        // Use the same API URL as PlannerDashboard\r\n        const API_URL =\r\n          process.env.NODE_ENV === \"production\"\r\n            ? \"https://quantix-production.up.railway.app\"\r\n            : \"http://localhost:5000\";\r\n\r\n        const response = await fetch(`${API_URL}/api/vendors`, {\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Accept: \"application/json\",\r\n            Authorization: `Bearer ${session.access_token}`,\r\n          },\r\n        });\r\n\r\n        if (!response.ok) {\r\n          throw new Error(\r\n            `Failed to fetch vendors: ${response.status} ${response.statusText}`\r\n          );\r\n        }\r\n\r\n        const data = await response.json();\r\n        if (!Array.isArray(data)) {\r\n          throw new Error(\"Invalid vendor data format received\");\r\n        }\r\n\r\n        console.log(\"Fetched vendors:\", data);\r\n        setAllVendors(data);\r\n        setFilteredVendors(data);\r\n      } catch (error) {\r\n        console.error(\"Error fetching vendors:\", error);\r\n        // Fallback to mock data in development\r\n        if (process.env.NODE_ENV === \"development\") {\r\n          console.warn(\"Using mock vendor data due to API error\");\r\n          setAllVendors(mockVendors);\r\n          setFilteredVendors(mockVendors);\r\n          setSearchError(\r\n            \"Using sample vendor data. Some features may be limited.\"\r\n          );\r\n        } else {\r\n          setSearchError(\"Failed to load vendors. Please try again later.\");\r\n        }\r\n      } finally {\r\n        setIsLoading(false);\r\n      }\r\n    };\r\n\r\n    fetchVendors();\r\n  }, []); // Empty dependency array since we don't have any external dependencies\r\n\r\n  // Debounced search effect\r\n  useEffect(() => {\r\n    if (searchTimeoutRef.current) {\r\n      clearTimeout(searchTimeoutRef.current);\r\n    }\r\n\r\n    if (searchInput.trim() === searchTerm) {\r\n      return;\r\n    }\r\n\r\n    setIsSearching(true);\r\n    searchTimeoutRef.current = setTimeout(() => {\r\n      setSearchTerm(searchInput.trim().toLowerCase());\r\n      setIsSearching(false);\r\n    }, 300);\r\n\r\n    return () => {\r\n      if (searchTimeoutRef.current) {\r\n        clearTimeout(searchTimeoutRef.current);\r\n      }\r\n    };\r\n  }, [searchInput, searchTerm]);\r\n\r\n  // Filter vendors based on search term and category\r\n  useEffect(() => {\r\n    const filterVendors = () => {\r\n      try {\r\n        let result = [...allVendors];\r\n\r\n        // Filter by category\r\n        if (selectedCategory !== \"All\") {\r\n          result = result.filter(\r\n            (v) =>\r\n              v.service_type &&\r\n              v.service_type.toLowerCase() === selectedCategory.toLowerCase()\r\n          );\r\n        }\r\n\r\n        // Filter by search term\r\n        if (searchTerm) {\r\n          result = result.filter((v) => {\r\n            const searchFields = [\r\n              v.business_name,\r\n              v.service_type,\r\n              v.contact_person,\r\n              v.email,\r\n              v.contact_number,\r\n              v.address,\r\n              v.description,\r\n            ]\r\n              .filter(Boolean)\r\n              .map((field) => field.toLowerCase());\r\n\r\n            return searchFields.some((field) => field.includes(searchTerm));\r\n          });\r\n        }\r\n\r\n        setFilteredVendors(result);\r\n        setSearchError(null);\r\n      } catch (error) {\r\n        console.error(\"Error filtering vendors:\", error);\r\n        setSearchError(\"An error occurred while searching. Please try again.\");\r\n      }\r\n    };\r\n\r\n    filterVendors();\r\n  }, [searchTerm, selectedCategory, allVendors]);\r\n\r\n  const handleAddVendor = async (vendor) => {\r\n    // Don’t add if already selected or request already sent\r\n    if (\r\n      selectedVendors.some((v) => v.vendor_id === vendor.vendor_id) ||\r\n      vendorRequests[vendor.vendor_id]\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // Set request as pending in local state\r\n      setVendorRequests((prev) => ({\r\n        ...prev,\r\n        [vendor.vendor_id]: { status: \"pending\" },\r\n      }));\r\n\r\n      // Get current user session\r\n      const {\r\n        data: { session },\r\n      } = await supabase.auth.getSession();\r\n      if (!session) {\r\n        throw new Error(\"No active session. Please log in.\");\r\n      }\r\n\r\n      // Get the current event ID (or temporary one if not saved yet)\r\n      const eventId = formData.event_id || `temp-${Date.now()}`;\r\n\r\n      // API base URL\r\n      const API_URL =\r\n        process.env.REACT_APP_BASE_URL ||\r\n        (process.env.NODE_ENV === \"production\"\r\n          ? \"https://quantix-production.up.railway.app\"\r\n          : \"http://localhost:5000\");\r\n\r\n      const isDevelopment = process.env.NODE_ENV === \"development\";\r\n\r\n      // Request body – only fields that exist in vendor_requests\r\n      const requestBody = {\r\n        event_id: eventId,\r\n        vendor_id: vendor.vendor_id,\r\n        requester_id: session.user.id,\r\n        status: \"pending\",\r\n      };\r\n\r\n      console.log(\"Sending vendor request:\", {\r\n        url: `${API_URL}/api/vendor-requests`,\r\n        method: \"POST\",\r\n        headers: {\r\n          \"Content-Type\": \"application/json\",\r\n          Authorization: `Bearer ${session.access_token?.substring(0, 10)}...`,\r\n        },\r\n        body: requestBody,\r\n      });\r\n\r\n      let responseData;\r\n\r\n      if (isDevelopment) {\r\n        console.log(\"Development mode: Using mock vendor request response\");\r\n        await new Promise((resolve) => setTimeout(resolve, 500));\r\n\r\n        responseData = {\r\n          success: true,\r\n          request: {\r\n            id: `mock-${Date.now()}`,\r\n            event_id: requestBody.event_id,\r\n            vendor_id: requestBody.vendor_id,\r\n            requester_id: requestBody.requester_id,\r\n            status: \"pending\",\r\n            created_at: new Date().toISOString(),\r\n          },\r\n        };\r\n      } else {\r\n        const response = await fetch(`${API_URL}/api/vendor-requests`, {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${session.access_token}`,\r\n          },\r\n          body: JSON.stringify(requestBody),\r\n        });\r\n\r\n        try {\r\n          responseData = await response.json();\r\n        } catch (err) {\r\n          const errorText = await response.text();\r\n          throw new Error(`Invalid JSON response: ${errorText}`);\r\n        }\r\n\r\n        if (!response.ok) {\r\n          const errorMessage =\r\n            responseData?.error ||\r\n            `Failed to send vendor request: ${response.status} ${response.statusText}`;\r\n          throw new Error(errorMessage);\r\n        }\r\n      }\r\n\r\n      // Update local state with actual request data\r\n      setVendorRequests((prev) => ({\r\n        ...prev,\r\n        [vendor.vendor_id]: {\r\n          status: responseData.request.status,\r\n          request_id: responseData.request.request_id,\r\n        },\r\n      }));\r\n\r\n      setSelectedVendors((prev) => [\r\n        ...prev,\r\n        {\r\n          ...vendor,\r\n          request_status: responseData.request.status,\r\n          request_id: responseData.request.request_id,\r\n        },\r\n      ]);\r\n\r\n      setSuccessMessage(`Request sent to ${vendor.business_name}`);\r\n      setShowSuccess(true);\r\n    } catch (error) {\r\n      console.error(\"Error sending vendor request:\", error);\r\n\r\n      // Remove pending status on error\r\n      const { [vendor.vendor_id]: _, ...remainingRequests } = vendorRequests;\r\n      setVendorRequests(remainingRequests);\r\n\r\n      setShowWarning(true);\r\n      setWarningMessage(\r\n        `Failed to send request to ${vendor.business_name}. ${\r\n          error.message || \"Unknown error occurred\"\r\n        }. Please try again or contact support if the problem persists.`\r\n      );\r\n\r\n      if (error.message.includes(\"401\")) {\r\n        setWarningMessage((prev) => prev + \" You may need to log in again.\");\r\n      }\r\n    }\r\n  };\r\n\r\n  const handleRemoveVendor = async (vendorToRemove) => {\r\n    const vendorName = vendorToRemove.business_name || \"Vendor\";\r\n\r\n    try {\r\n      // If there's a pending/accepted request, we should cancel it\r\n      if (vendorToRemove.request_id) {\r\n        const {\r\n          data: { session },\r\n        } = await supabase.auth.getSession();\r\n        if (!session) {\r\n          throw new Error(\"No active session\");\r\n        }\r\n\r\n        const API_URL =\r\n          process.env.REACT_APP_BASE_URL ||\r\n          (process.env.NODE_ENV === \"production\"\r\n            ? \"https://quantix-production.up.railway.app\"\r\n            : \"http://localhost:5000\");\r\n\r\n        // In development, just simulate the deletion\r\n        if (process.env.NODE_ENV === \"development\") {\r\n          console.log(\r\n            \"Development mode: Simulating request cancellation for\",\r\n            vendorToRemove.request_id\r\n          );\r\n          await new Promise((resolve) => setTimeout(resolve, 500));\r\n        } else {\r\n          // Make the actual API call in production\r\n          const response = await fetch(\r\n            `${API_URL}/api/vendor-requests/${vendorToRemove.request_id}`,\r\n            {\r\n              method: \"DELETE\",\r\n              headers: {\r\n                \"Content-Type\": \"application/json\",\r\n                Authorization: `Bearer ${session.access_token}`,\r\n              },\r\n            }\r\n          );\r\n\r\n          if (!response.ok) {\r\n            const errorData = await response.json().catch(() => ({}));\r\n            throw new Error(\r\n              errorData.message ||\r\n                `Failed to cancel request: ${response.status} ${response.statusText}`\r\n            );\r\n          }\r\n        }\r\n      }\r\n\r\n      // Remove from selected vendors\r\n      setSelectedVendors((prev) =>\r\n        prev.filter((vendor) => vendor.vendor_id !== vendorToRemove.vendor_id)\r\n      );\r\n\r\n      // Remove from requests tracking\r\n      setVendorRequests((prev) => {\r\n        const { [vendorToRemove.vendor_id]: _, ...remaining } = prev;\r\n        return remaining;\r\n      });\r\n\r\n      // Show success message\r\n      setSuccessMessage(`Request to ${vendorName} has been cancelled.`);\r\n      setShowSuccess(true);\r\n    } catch (error) {\r\n      console.error(\"Error cancelling vendor request:\", error);\r\n      setWarningMessage(\r\n        `Failed to cancel request to ${vendorName}. ` +\r\n          `${error.message || \"Please try again.\"}`\r\n      );\r\n      setShowWarning(true);\r\n    }\r\n  };\r\n\r\n  const getVendorStatus = (vendor) => {\r\n    if (vendor.request_id) {\r\n      return vendor.request_status;\r\n    } else if (vendorRequests[vendor.vendor_id]) {\r\n      return vendorRequests[vendor.vendor_id].status;\r\n    } else {\r\n      return null;\r\n    }\r\n  };\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setIsSubmitting(true);\r\n    setShowWarning(false);\r\n    setShowSuccess(false);\r\n\r\n    // Basic validation\r\n    if (!formData.name || !formData.date) {\r\n      setWarningMessage(\"Please fill in at least the event name and date.\");\r\n      setShowWarning(true);\r\n      setIsSubmitting(false);\r\n      return;\r\n    }\r\n\r\n    const {\r\n      data: { user },\r\n    } = await supabase.auth.getUser();\r\n    if (!user) {\r\n      setWarningMessage(\"You must be logged in to create an event.\");\r\n      setShowWarning(true);\r\n      setIsSubmitting(false);\r\n      return;\r\n    }\r\n\r\n    const selectedDate = new Date(formData.date);\r\n    const today = new Date();\r\n    today.setHours(0, 0, 0, 0);\r\n    if (selectedDate < today) {\r\n      setWarningMessage(\"Please select a future date.\");\r\n      setShowWarning(true);\r\n      setIsSubmitting(false);\r\n      return;\r\n    }\r\n\r\n    try {\r\n      // 1️⃣ Create event in Supabase\r\n      const { data: eventData, error: eventError } = await supabase\r\n        .from(\"events\")\r\n        .insert({\r\n          name: formData.name,\r\n          theme: formData.theme || null,\r\n          start_time: formData.time\r\n            ? `${formData.date}T${formData.time}`\r\n            : `${formData.date}T00:00:00`,\r\n          end_time: formData.end_time || null,\r\n          venue: formData.venue || null,\r\n          planner_id: user.id,\r\n        })\r\n        .select()\r\n        .single();\r\n\r\n      if (eventError) throw eventError;\r\n\r\n      setFormData((prev) => ({ ...prev, event_id: eventData.event_id }));\r\n\r\n      // 2️⃣ Send vendor requests via backend API\r\n      const API_URL =\r\n        process.env.REACT_APP_BASE_URL ||\r\n        (process.env.NODE_ENV === \"production\"\r\n          ? \"https://quantix-production.up.railway.app\"\r\n          : \"http://localhost:5000\");\r\n\r\n      for (const vendor of selectedVendors) {\r\n        const response = await fetch(`${API_URL}/api/vendor-requests`, {\r\n          method: \"POST\",\r\n          headers: {\r\n            \"Content-Type\": \"application/json\",\r\n            Authorization: `Bearer ${user.id}`,\r\n          },\r\n          body: JSON.stringify({\r\n            event_id: eventData.event_id,\r\n            vendor_id: vendor.vendor_id,\r\n            requester_id: user.id,\r\n          }),\r\n        });\r\n\r\n        const data = await response.json();\r\n        if (!response.ok) {\r\n          console.error(\"Failed to send vendor request:\", data.error);\r\n          throw new Error(\r\n            data.error ||\r\n              `Failed to send request for vendor ${vendor.vendor_id}`\r\n          );\r\n        }\r\n      }\r\n\r\n      // 3️⃣ Upload documents to Supabase Storage\r\n      if (documents.length > 0) {\r\n        const uploadedDocuments = await Promise.all(\r\n          documents.map(async (docFile) => {\r\n            const safeEventName = formData.name\r\n              .replace(/\\s+/g, \"_\")\r\n              .replace(/[^\\w-]/g, \"\");\r\n            const filePath = `planners/${user.id}/${safeEventName}/${docFile.name}`;\r\n\r\n            const { error: uploadError } = await supabase.storage\r\n              .from(\"event-documents\")\r\n              .upload(filePath, docFile);\r\n\r\n            if (uploadError) throw uploadError;\r\n\r\n            const {\r\n              data: { publicUrl },\r\n            } = supabase.storage.from(\"event-documents\").getPublicUrl(filePath);\r\n\r\n            return {\r\n              name: docFile.name,\r\n              url: publicUrl,\r\n              file_type: docFile.type || \"application/octet-stream\",\r\n            };\r\n          })\r\n        );\r\n\r\n        // Insert file records into files table\r\n        const fileRecords = uploadedDocuments.map((doc) => ({\r\n          event_id: eventData.event_id,\r\n          uploaded_by: user.id,\r\n          file_name: doc.name,\r\n          file_type: doc.file_type,\r\n          file_url: doc.url,\r\n        }));\r\n\r\n        const { error: fileError } = await supabase\r\n          .from(\"files\")\r\n          .insert(fileRecords);\r\n\r\n        if (fileError) throw fileError;\r\n      }\r\n\r\n      setSuccessMessage(\"Event created successfully!\");\r\n      setShowSuccess(true);\r\n    } catch (error) {\r\n      console.error(\"Error creating event:\", error);\r\n      setWarningMessage(\r\n        error.message || \"Failed to create event. Please try again.\"\r\n      );\r\n      setShowWarning(true);\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    const handleClickOutside = (event) => {\r\n      if (showVenueDropdown && !event.target.closest(\".form-group\")) {\r\n        setShowVenueDropdown(false);\r\n      }\r\n    };\r\n\r\n    document.addEventListener(\"mousedown\", handleClickOutside);\r\n    return () => {\r\n      document.removeEventListener(\"mousedown\", handleClickOutside);\r\n    };\r\n  }, [showVenueDropdown]);\r\n\r\n  return (\r\n    <>\r\n      {showSuccess && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: \"rgba(0, 0, 0, 0.8)\",\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            zIndex: 10000,\r\n            animation: \"fadeIn 0.3s ease-out\",\r\n            pointerEvents: \"auto\",\r\n            backdropFilter: \"blur(2px)\",\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: \"white\",\r\n              borderRadius: \"16px\",\r\n              boxShadow: \"0 8px 32px rgba(0, 0, 0, 0.3)\",\r\n              padding: \"2.5rem 3rem\",\r\n              position: \"relative\",\r\n              minWidth: \"350px\",\r\n              maxWidth: \"90%\",\r\n              textAlign: \"center\",\r\n              border: \"2px solid #E5ACBF\",\r\n              zIndex: 10001,\r\n            }}\r\n          >\r\n            <button\r\n              onClick={() => {\r\n                setShowSuccess(false);\r\n                // ===== FIX #2: Only navigate if it's the event creation message =====\r\n                if (successMessage === \"Event created successfully!\") {\r\n                  navigate(\"/dashboard\");\r\n                }\r\n              }}\r\n              style={{\r\n                position: \"absolute\",\r\n                top: \"0.75rem\",\r\n                right: \"1rem\",\r\n                background: \"none\",\r\n                border: \"none\",\r\n                fontSize: \"1.5rem\",\r\n                cursor: \"pointer\",\r\n                color: \"#666\",\r\n                padding: \"0.25rem 0.5rem\",\r\n                lineHeight: 1,\r\n                fontWeight: \"bold\",\r\n                transition: \"color 0.2s\",\r\n              }}\r\n              onMouseOver={(e) => (e.target.style.color = \"#E5ACBF\")}\r\n              onMouseOut={(e) => (e.target.style.color = \"#666\")}\r\n            >\r\n              &times;\r\n            </button>\r\n            <p\r\n              style={{\r\n                margin: \"1rem 0 0\",\r\n                color: \"#333\",\r\n                fontWeight: 500,\r\n                fontSize: \"1.1rem\",\r\n                padding: \"0 1rem\",\r\n              }}\r\n            >\r\n              {/* ===== FIX #3: Display the dynamic success message ===== */}\r\n              {successMessage}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n      {showWarning && (\r\n        <div\r\n          style={{\r\n            position: \"fixed\",\r\n            top: 0,\r\n            left: 0,\r\n            right: 0,\r\n            bottom: 0,\r\n            backgroundColor: \"rgba(0, 0, 0, 0.8)\",\r\n            display: \"flex\",\r\n            justifyContent: \"center\",\r\n            alignItems: \"center\",\r\n            zIndex: 10000,\r\n            animation: \"fadeIn 0.3s ease-out\",\r\n            pointerEvents: \"auto\",\r\n            backdropFilter: \"blur(2px)\",\r\n          }}\r\n        >\r\n          <div\r\n            style={{\r\n              background: \"white\",\r\n              borderRadius: \"16px\",\r\n              boxShadow: \"0 8px 32px rgba(0, 0, 0, 0.3)\",\r\n              padding: \"2.5rem 3rem\",\r\n              position: \"relative\",\r\n              minWidth: \"350px\",\r\n              maxWidth: \"90%\",\r\n              textAlign: \"center\",\r\n              border: \"2px solid #E5ACBF\",\r\n              zIndex: 10001,\r\n            }}\r\n          >\r\n            <button\r\n              onClick={() => setShowWarning(false)}\r\n              style={{\r\n                position: \"absolute\",\r\n                top: \"0.75rem\",\r\n                right: \"1rem\",\r\n                background: \"none\",\r\n                border: \"none\",\r\n                fontSize: \"1.5rem\",\r\n                cursor: \"pointer\",\r\n                color: \"#666\",\r\n                padding: \"0.25rem 0.5rem\",\r\n                lineHeight: 1,\r\n                fontWeight: \"bold\",\r\n                transition: \"color 0.2s\",\r\n              }}\r\n              onMouseOver={(e) => (e.target.style.color = \"#E5ACBF\")}\r\n              onMouseOut={(e) => (e.target.style.color = \"#666\")}\r\n            >\r\n              &times;\r\n            </button>\r\n            <p\r\n              style={{\r\n                margin: \"1rem 0 0\",\r\n                color: \"#333\",\r\n                fontWeight: 500,\r\n                fontSize: \"1.1rem\",\r\n                padding: \"0 1rem\",\r\n              }}\r\n            >\r\n              {warningMessage}\r\n            </p>\r\n          </div>\r\n        </div>\r\n      )}\r\n\r\n      <div className=\"profile-container\">\r\n        <button className=\"back-button\" onClick={() => navigate(\"/dashboard\")}>\r\n          <FaArrowLeft /> Back to Dashboard\r\n        </button>\r\n\r\n        <h1>\r\n          Create a New <span className=\"accent-text\">Event</span>\r\n        </h1>\r\n        <p>Plan your perfect event by adding details, vendors, and documents</p>\r\n\r\n        <div className=\"form-sections\">\r\n          <form className=\"profile-form\" onSubmit={handleSubmit}>\r\n            {/* Event Name */}\r\n            <div className=\"form-group\">\r\n              <input\r\n                type=\"text\"\r\n                name=\"name\"\r\n                value={formData.name}\r\n                onChange={handleChange}\r\n                className=\"form-input\"\r\n                required\r\n              />\r\n              <label className=\"form-label\">Event Name</label>\r\n            </div>\r\n\r\n            {/* Event Date and Time */}\r\n            <div style={{ display: \"flex\", gap: \"1rem\" }}>\r\n              <div className=\"form-group\" style={{ flex: 1 }}>\r\n                <FaCalendarAlt className=\"form-icon\" />\r\n                <input\r\n                  type=\"date\"\r\n                  name=\"date\"\r\n                  value={formData.date}\r\n                  min={new Date().toISOString().split(\"T\")[0]}\r\n                  onChange={handleChange}\r\n                  className=\"form-input\"\r\n                  required\r\n                />\r\n                <label className=\"form-label\">Date</label>\r\n              </div>\r\n\r\n              <div className=\"form-group\" style={{ flex: 1 }}>\r\n                <FaClock className=\"form-icon\" />\r\n                <input\r\n                  type=\"time\"\r\n                  name=\"time\"\r\n                  value={formData.time}\r\n                  onChange={handleChange}\r\n                  className=\"form-input\"\r\n                />\r\n                <label className=\"form-label\">Time (Optional)</label>\r\n              </div>\r\n            </div>\r\n\r\n            {/* Theme and Venue */}\r\n            <div style={{ display: \"flex\", gap: \"1rem\" }}>\r\n              <div className=\"form-group\" style={{ flex: 1 }}>\r\n                <input\r\n                  type=\"text\"\r\n                  name=\"theme\"\r\n                  value={formData.theme}\r\n                  onChange={handleChange}\r\n                  className=\"form-input\"\r\n                />\r\n                <label className=\"form-label\">Theme (Optional)</label>\r\n              </div>\r\n\r\n              <div\r\n                className=\"form-group\"\r\n                style={{ flex: 1, position: \"relative\" }}\r\n              >\r\n                <div style={{ position: \"relative\" }}>\r\n                  <input\r\n                    type=\"text\"\r\n                    name=\"venue\"\r\n                    value={formData.venue}\r\n                    onChange={handleChange}\r\n                    className=\"form-input\"\r\n                    disabled={usingVenueVendor}\r\n                    onFocus={() =>\r\n                      usingVenueVendor && setShowVenueDropdown(true)\r\n                    }\r\n                    style={\r\n                      usingVenueVendor\r\n                        ? {\r\n                            backgroundColor: \"#f5f5f5\",\r\n                            cursor: \"pointer\",\r\n                            paddingRight: \"35px\",\r\n                          }\r\n                        : {}\r\n                    }\r\n                  />\r\n                  <label className=\"form-label\">\r\n                    {usingVenueVendor\r\n                      ? \"Venue (Selected from Vendor)\"\r\n                      : \"Venue (Optional)\"}\r\n                  </label>\r\n                  {usingVenueVendor &&\r\n                    selectedVenueVendor?.venue_names?.length > 1 && (\r\n                      <div style={{ position: \"relative\" }}>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() =>\r\n                            setShowVenueDropdown(!showVenueDropdown)\r\n                          }\r\n                          style={{\r\n                            position: \"absolute\",\r\n                            right: \"30px\",\r\n                            top: \"50%\",\r\n                            transform: \"translateY(-50%)\",\r\n                            background: \"none\",\r\n                            border: \"none\",\r\n                            color: \"#666\",\r\n                            cursor: \"pointer\",\r\n                            fontSize: \"0.8rem\",\r\n                            padding: \"2px 5px\",\r\n                            borderRadius: \"4px\",\r\n                            transition: \"all 0.2s\",\r\n                          }}\r\n                          onMouseOver={(e) =>\r\n                            (e.target.style.background = \"rgba(0,0,0,0.05)\")\r\n                          }\r\n                          onMouseOut={(e) =>\r\n                            (e.target.style.background = \"transparent\")\r\n                          }\r\n                          title=\"Select a different venue\"\r\n                        >\r\n                          ▼\r\n                        </button>\r\n                        {showVenueDropdown && (\r\n                          <div\r\n                            style={{\r\n                              position: \"absolute\",\r\n                              top: \"100%\",\r\n                              left: 0,\r\n                              right: 0,\r\n                              backgroundColor: \"white\",\r\n                              border: \"1px solid #ddd\",\r\n                              borderRadius: \"4px\",\r\n                              boxShadow: \"0 4px 8px rgba(0,0,0,0.1)\",\r\n                              zIndex: 1000,\r\n                              maxHeight: \"200px\",\r\n                              overflowY: \"auto\",\r\n                              marginTop: \"4px\",\r\n                            }}\r\n                          >\r\n                            {selectedVenueVendor.venue_names.map(\r\n                              (venue, idx) => (\r\n                                <div\r\n                                  key={idx}\r\n                                  onClick={() => {\r\n                                    setFormData((prev) => ({\r\n                                      ...prev,\r\n                                      venue,\r\n                                    }));\r\n                                    setSelectedVenueIndex(idx);\r\n                                    setShowVenueDropdown(false);\r\n                                  }}\r\n                                  style={{\r\n                                    padding: \"8px 12px\",\r\n                                    cursor: \"pointer\",\r\n                                    backgroundColor:\r\n                                      idx === selectedVenueIndex\r\n                                        ? \"#f0f0f0\"\r\n                                        : \"transparent\",\r\n                                    \":hover\": {\r\n                                      backgroundColor: \"#f5f5f5\",\r\n                                    },\r\n                                  }}\r\n                                >\r\n                                  {venue}\r\n                                </div>\r\n                              )\r\n                            )}\r\n                          </div>\r\n                        )}\r\n                      </div>\r\n                    )}\r\n                  {usingVenueVendor && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setUsingVenueVendor(false);\r\n                        setFormData((prev) => ({ ...prev, venue: \"\" }));\r\n                        setShowVenueDropdown(false);\r\n                      }}\r\n                      style={{\r\n                        position: \"absolute\",\r\n                        right: \"10px\",\r\n                        top: \"50%\",\r\n                        transform: \"translateY(-50%)\",\r\n                        background: \"none\",\r\n                        border: \"none\",\r\n                        color: \"#666\",\r\n                        cursor: \"pointer\",\r\n                        fontSize: \"1rem\",\r\n                        padding: \"5px\",\r\n                        borderRadius: \"50%\",\r\n                        display: \"flex\",\r\n                        alignItems: \"center\",\r\n                        justifyContent: \"center\",\r\n                        transition: \"all 0.2s\",\r\n                      }}\r\n                      onMouseOver={(e) =>\r\n                        (e.target.style.background = \"rgba(0,0,0,0.05)\")\r\n                      }\r\n                      onMouseOut={(e) =>\r\n                        (e.target.style.background = \"transparent\")\r\n                      }\r\n                      title=\"Use custom venue name instead\"\r\n                    >\r\n                      <FaTimes />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              </div>\r\n            </div>\r\n\r\n            {/* End Time */}\r\n            <div className=\"form-group\">\r\n              <FaClock className=\"form-icon\" />\r\n              <input\r\n                type=\"time\"\r\n                name=\"end_time\"\r\n                value={formData.end_time}\r\n                onChange={handleChange}\r\n                className=\"form-input\"\r\n              />\r\n              <label className=\"form-label\">End Time (Optional)</label>\r\n            </div>\r\n\r\n            {/* Vendors Section */}\r\n            <div className=\"optional-section\">\r\n              <h3>\r\n                <FaUsers /> Vendors{\" \"}\r\n                <span className=\"optional-tag\">Optional</span>\r\n              </h3>\r\n              <p className=\"section-description\">\r\n                Add vendors to your event to keep everything organized in one\r\n                place\r\n              </p>\r\n\r\n              <div className=\"vendor-search-container\">\r\n                <div className=\"search-box\">\r\n                  <FaSearch className=\"search-icon\" />\r\n                  <input\r\n                    type=\"text\"\r\n                    placeholder=\"Search for vendors by name or category\"\r\n                    value={searchInput}\r\n                    onChange={(e) => setSearchInput(e.target.value)}\r\n                    className=\"search-input\"\r\n                    disabled={isLoading}\r\n                  />\r\n                  {(isSearching || isLoading) && (\r\n                    <div className=\"search-loading\">\r\n                      <div className=\"spinner\"></div>\r\n                    </div>\r\n                  )}\r\n                  {!isSearching && searchInput && (\r\n                    <button\r\n                      type=\"button\"\r\n                      onClick={() => {\r\n                        setSearchInput(\"\");\r\n                        setSearchTerm(\"\");\r\n                      }}\r\n                      className=\"clear-search\"\r\n                      aria-label=\"Clear search\"\r\n                    >\r\n                      <FaTimes />\r\n                    </button>\r\n                  )}\r\n                </div>\r\n\r\n                <select\r\n                  value={selectedCategory}\r\n                  onChange={(e) => setSelectedCategory(e.target.value)}\r\n                  className=\"category-filter\"\r\n                >\r\n                  <option value=\"All\">All Categories</option>\r\n                  {vendorCategories.map((cat, idx) => (\r\n                    <option key={idx} value={cat}>\r\n                      {cat}\r\n                    </option>\r\n                  ))}\r\n                </select>\r\n              </div>\r\n\r\n              {searchError && (\r\n                <div className=\"search-error\">\r\n                  <FaTimes className=\"error-icon\" /> {searchError}\r\n                </div>\r\n              )}\r\n\r\n              {isLoading ? (\r\n                <div className=\"loading\">\r\n                  <div className=\"spinner\"></div>\r\n                  <p>Loading vendors...</p>\r\n                </div>\r\n              ) : isSearching ? (\r\n                <div className=\"loading\">\r\n                  <div className=\"spinner\"></div>\r\n                  <p>Searching vendors...</p>\r\n                </div>\r\n              ) : filteredVendors.length === 0 ? (\r\n                <div className=\"no-results\">\r\n                  <p>No vendors found matching your search.</p>\r\n                  {searchTerm && (\r\n                    <button\r\n                      type=\"button\"\r\n                      className=\"clear-filters\"\r\n                      onClick={() => {\r\n                        setSearchInput(\"\");\r\n                        setSearchTerm(\"\");\r\n                        setSelectedCategory(\"All\");\r\n                      }}\r\n                    >\r\n                      Clear all filters\r\n                    </button>\r\n                  )}\r\n                </div>\r\n              ) : (\r\n                <div className=\"vendor-grid\">\r\n                  {filteredVendors.map((vendor) => (\r\n                    <div\r\n                      key={vendor.vendor_id}\r\n                      className=\"vendor-card\"\r\n                      onClick={(e) => {\r\n                        // Only navigate if the click is not on the request button or its children\r\n                        if (!e.target.closest('.add-vendor-btn, .undo-request-btn')) {\r\n                          handleVendorCardClick(vendor.vendor_id);\r\n                        }\r\n                      }}\r\n                      style={{ cursor: 'pointer' }}\r\n                    >\r\n                      <div className=\"vendor-info\">\r\n                        <h4>{vendor.business_name}</h4>\r\n                        <div className=\"vendor-category\">\r\n                          {vendor.service_type}\r\n                        </div>\r\n                        <div className=\"vendor-description\">\r\n                          {vendor.description || \"No description available.\"}\r\n                        </div>\r\n                      </div>\r\n                      <div className=\"vendor-actions\">\r\n                        <button\r\n                          type=\"button\"\r\n                          className={`add-vendor-btn ${\r\n                            getVendorStatus(vendor) ? \"added\" : \"\"\r\n                          } ${\r\n                            getVendorStatus(vendor) === \"pending\"\r\n                              ? \"pending\"\r\n                              : \"\"\r\n                          }`}\r\n                          onClick={() => handleAddVendor(vendor)}\r\n                          disabled={!!getVendorStatus(vendor)}\r\n                          title={\r\n                            getVendorStatus(vendor) === \"pending\"\r\n                              ? \"Request pending\"\r\n                              : \"\"\r\n                          }\r\n                        >\r\n                          {getVendorStatus(vendor) === \"pending\" ? (\r\n                            <>\r\n                              <FaClock /> Requested\r\n                            </>\r\n                          ) : getVendorStatus(vendor) === \"accepted\" ? (\r\n                            <>\r\n                              <FaCheck /> Confirmed\r\n                            </>\r\n                          ) : getVendorStatus(vendor) === \"rejected\" ? (\r\n                            <>\r\n                              <FaTimes /> Declined\r\n                            </>\r\n                          ) : (\r\n                            <>\r\n                              <FaPlus /> Request Vendor\r\n                            </>\r\n                          )}\r\n                        </button>\r\n                        {getVendorStatus(vendor) === \"pending\" && (\r\n                          <button\r\n                            type=\"button\"\r\n                            className=\"undo-request-btn\"\r\n                            onClick={(e) => {\r\n                              e.stopPropagation();\r\n                              e.preventDefault();\r\n                              handleRemoveVendor(vendor);\r\n                            }}\r\n                            onKeyDown={(e) => {\r\n                              if (e.key === \"Enter\" || e.key === \" \") {\r\n                                e.stopPropagation();\r\n                                e.preventDefault();\r\n                                handleRemoveVendor(vendor);\r\n                              }\r\n                            }}\r\n                            title=\"Cancel request\"\r\n                          >\r\n                            Undo\r\n                          </button>\r\n                        )}\r\n                      </div>\r\n                    </div>\r\n                  ))}\r\n                </div>\r\n              )}\r\n\r\n              {selectedVendors.length > 0 && (\r\n                <div className=\"selected-vendors\">\r\n                  <h3 className=\"selected-title\">Selected Vendors</h3>\r\n                  <ul className=\"selected-vendors-list\">\r\n                    {selectedVendors.map((v) => (\r\n                      <li key={v.vendor_id} className=\"selected-vendor-item\">\r\n                        <div>\r\n                          <span className=\"vendor-name\">{v.business_name}</span>\r\n                          <span className=\"vendor-type\">{v.service_type}</span>\r\n                        </div>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => handleRemoveVendor(v)}\r\n                          className=\"remove-vendor-btn\"\r\n                          title=\"Remove vendor\"\r\n                        >\r\n                          <FaTimes />\r\n                        </button>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            {/* Documents Section */}\r\n            <div className=\"optional-section\">\r\n              <h3>\r\n                <FaFileAlt /> Documents{\" \"}\r\n                <span className=\"optional-tag\">Optional</span>\r\n              </h3>\r\n              <p className=\"section-description\">\r\n                Upload contracts, invoices, or other important files related to\r\n                your event\r\n              </p>\r\n\r\n              <div className=\"file-upload-area\">\r\n                <label className=\"file-upload-label\">\r\n                  <input\r\n                    type=\"file\"\r\n                    multiple\r\n                    onChange={handleFileChange}\r\n                    className=\"file-input\"\r\n                  />\r\n                  <FaUpload className=\"upload-icon\" />\r\n                  <h3 className=\"upload-title\">Upload Files</h3>\r\n                  <p className=\"upload-subtitle\">\r\n                    Drag & drop files here or click to browse\r\n                  </p>\r\n                  <p className=\"upload-hint\">\r\n                    Maximum file size: 10MB per file\r\n                  </p>\r\n                </label>\r\n              </div>\r\n\r\n              {documents.length > 0 && (\r\n                <div className=\"documents-list\">\r\n                  <h3 className=\"documents-title\">Uploaded Files</h3>\r\n                  <ul className=\"documents-container\">\r\n                    {documents.map((doc, idx) => (\r\n                      <li key={idx} className=\"document-item\">\r\n                        <FaFileAlt className=\"file-icon\" />\r\n                        <span className=\"file-name\">{doc.name}</span>\r\n                        <span className=\"file-size\">\r\n                          ({(doc.size / 1024).toFixed(1)} KB)\r\n                        </span>\r\n                        <button\r\n                          type=\"button\"\r\n                          onClick={() => handleRemoveDocument(doc)}\r\n                          className=\"remove-document-btn\"\r\n                          title=\"Remove file\"\r\n                        >\r\n                          <FaTimes />\r\n                        </button>\r\n                      </li>\r\n                    ))}\r\n                  </ul>\r\n                </div>\r\n              )}\r\n            </div>\r\n\r\n            <div className=\"form-actions\">\r\n              <button\r\n                type=\"button\"\r\n                className=\"cancel-btn\"\r\n                onClick={() => {\r\n                  setShowWarning(false);\r\n                  navigate(\"/dashboard\");\r\n                }}\r\n              >\r\n                Cancel\r\n              </button>\r\n              <button\r\n                type=\"submit\"\r\n                className=\"submit-btn\"\r\n                disabled={isSubmitting}\r\n              >\r\n                {isSubmitting ? \"Creating Event...\" : \"Create Event\"}\r\n              </button>\r\n            </div>\r\n          </form>\r\n        </div>\r\n      </div>\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}